# CRM система для психологического центра

Полнофункциональная CRM система для управления психологическим центром, включающая управление клиентами, психологами, записями на прием, сеансами и платежами.

## Возможности

- **Управление клиентами**: Добавление, редактирование и отслеживание информации о клиентах
- **Управление психологами**: Ведение базы специалистов с их специализациями и ставками
- **Запись на прием**: Планирование и управление консультациями
- **История сеансов**: Детальная документация проведенных сеансов с диагнозами и рекомендациями
- **Финансовый учет**: Отслеживание платежей и доходов
- **Панель управления**: Статистика и аналитика работы центра
- **Аутентификация**: Безопасный вход в систему с JWT токенами

## Технологический стек

### Backend
- Node.js
- Express.js
- SQLite (легко мигрируется на PostgreSQL)
- JWT для аутентификации
- bcryptjs для хеширования паролей

### Frontend
- React 18
- React Router v6
- Axios
- CSS3

## Установка и запуск

### Предварительные требования

- Node.js (версия 14 или выше)
- npm или yarn

### Установка

1. Клонируйте репозиторий:
```bash
git clone <url-репозитория>
cd crm
```

2. Установите зависимости для backend и frontend:
```bash
npm run install-all
```

3. Создайте файл `.env` на основе `.env.example`:
```bash
cp .env.example .env
```

### Запуск приложения

#### Режим разработки

1. Запустите backend сервер (в одном терминале):
```bash
npm run dev
```

2. Запустите frontend (в другом терминале):
```bash
npm run client
```

Backend будет доступен по адресу: `http://localhost:5000`
Frontend будет доступен по адресу: `http://localhost:3000`

#### Режим production

1. Соберите frontend:
```bash
npm run build
```

2. Запустите backend:
```bash
npm start
```

## Использование

### Вход в систему

По умолчанию создается тестовый пользователь:
- **Логин**: admin
- **Пароль**: admin123

### Основные разделы

1. **Главная (Dashboard)** - Панель управления с общей статистикой:
   - Количество активных клиентов
   - Количество активных психологов
   - Запланированные записи
   - Доход за месяц
   - Количество сеансов за месяц
   - Список ближайших записей

2. **Клиенты** - Управление базой клиентов:
   - Добавление новых клиентов
   - Редактирование информации
   - Просмотр истории сеансов
   - Контактная информация
   - Экстренные контакты

3. **Психологи** - Управление специалистами:
   - Информация о специалистах
   - Специализации
   - Образование и опыт
   - Ставки за час работы

4. **Записи на прием** - Планирование консультаций:
   - Создание новых записей
   - Назначение клиента и психолога
   - Установка даты и времени
   - Управление статусами (запланирована/завершена/отменена)

5. **Сеансы** - История проведенных сеансов:
   - Документирование проведенных консультаций
   - Диагнозы и заключения
   - Рекомендации для клиентов
   - Планирование следующих сеансов

6. **Платежи** - Финансовый учет:
   - Регистрация платежей
   - Различные способы оплаты (наличные, карта, перевод)
   - Статус платежей
   - Общая статистика доходов

## Структура проекта

```
crm/
├── server/                 # Backend
│   ├── config/            # Конфигурация (БД)
│   ├── controllers/       # Контроллеры
│   ├── middleware/        # Middleware (аутентификация)
│   ├── routes/           # API маршруты
│   └── index.js          # Точка входа сервера
├── client/                # Frontend
│   ├── public/           # Статические файлы
│   └── src/
│       ├── api/          # API клиент (axios)
│       ├── components/   # Компоненты React
│       ├── context/      # Context API (Auth)
│       ├── pages/        # Страницы приложения
│       ├── App.js        # Главный компонент
│       └── index.js      # Точка входа
├── database.sqlite        # База данных (создается автоматически)
├── package.json          # Зависимости backend
└── README.md            # Документация

```

## API Endpoints

### Аутентификация
- `POST /api/auth/login` - Вход в систему
- `POST /api/auth/register` - Регистрация нового пользователя
- `GET /api/auth/me` - Получить текущего пользователя

### Клиенты
- `GET /api/clients` - Получить всех клиентов
- `GET /api/clients/:id` - Получить клиента по ID
- `POST /api/clients` - Создать нового клиента
- `PUT /api/clients/:id` - Обновить клиента
- `DELETE /api/clients/:id` - Удалить клиента
- `GET /api/clients/:id/sessions` - Получить сеансы клиента

### Психологи
- `GET /api/psychologists` - Получить всех психологов
- `GET /api/psychologists/:id` - Получить психолога по ID
- `POST /api/psychologists` - Создать нового психолога
- `PUT /api/psychologists/:id` - Обновить психолога
- `DELETE /api/psychologists/:id` - Удалить психолога

### Записи
- `GET /api/appointments` - Получить все записи
- `GET /api/appointments/:id` - Получить запись по ID
- `POST /api/appointments` - Создать новую запись
- `PUT /api/appointments/:id` - Обновить запись
- `DELETE /api/appointments/:id` - Удалить запись
- `GET /api/appointments/date/:date` - Получить записи по дате

### Сеансы
- `GET /api/sessions` - Получить все сеансы
- `GET /api/sessions/:id` - Получить сеанс по ID
- `POST /api/sessions` - Создать новый сеанс
- `PUT /api/sessions/:id` - Обновить сеанс
- `DELETE /api/sessions/:id` - Удалить сеанс

### Платежи
- `GET /api/payments` - Получить все платежи
- `GET /api/payments/:id` - Получить платеж по ID
- `POST /api/payments` - Создать новый платеж
- `PUT /api/payments/:id` - Обновить платеж
- `DELETE /api/payments/:id` - Удалить платеж
- `GET /api/payments/client/:clientId` - Получить платежи клиента

### Dashboard
- `GET /api/dashboard/statistics` - Получить общую статистику
- `GET /api/dashboard/recent-appointments` - Получить ближайшие записи
- `GET /api/dashboard/revenue-by-month` - Получить доход по месяцам

## База данных

Приложение использует SQLite для хранения данных. База данных создается автоматически при первом запуске.

### Таблицы:
- `users` - Пользователи системы
- `clients` - Клиенты
- `psychologists` - Психологи
- `appointments` - Записи на прием
- `sessions` - История сеансов
- `payments` - Платежи

## Безопасность

- Все пароли хешируются с использованием bcryptjs
- JWT токены для аутентификации
- Защита всех API endpoints (кроме /login)
- HTTP-only cookies (можно настроить)

## Дальнейшее развитие

Возможные улучшения:
- Добавление email уведомлений
- SMS напоминания о записях
- Экспорт отчетов в PDF/Excel
- Календарь с визуализацией записей
- Расширенная аналитика
- Миграция на PostgreSQL для production
- Добавление ролей (админ, менеджер, психолог)
- Мобильное приложение

## Лицензия

MIT

## Поддержка

Для вопросов и предложений создавайте issue в репозитории.
